<jsp:include page="/jsp/includes/homeHead.jsp" >
	<jsp:param name="navpath" value="The VFB Site@/site/vfb_site/home.htm|Features@ " />
	<jsp:param name="title" value="Features" />
</jsp:include>



<div class="row row-centered">

	<div class="col-md-9 col-centered">
		<div class="jumbotron" align="center">
			<jsp:include page="/site/vfb_site/whats_new.htm" />
		</div>

		<div class="center-wide">



			<p class="lead">
				Welcome to <b>Virtual Fly Brain (VFB)</b> - an interactive tool for neurobiologists to explore the detailed neuroanatomy, neuron connectivity and gene expression of <i>Drosophila melanogaster</i>.
				 Our goal is to make it easier for researchers to find relevant anatomical information and reagents.
				</p>
				
				<p>		
				We integrate the neuroanatomical and expression data from the published literature, as well as image datasets onto the same brain template, making it possible to run cross searches, find similar neurons and compare image data on our <a href="../../site/stacks/index.htm">3D Viewer</a>.
			</p>

			<p>
				Our site provides several anatomy browsing, image display and querying tools. Below is a short description of the datasets and tools available and what they will allow you to do.</p>
				
				<p>
				For more detailed information on each tool please check our <a href="tutorial.htm">Tutorial videos</a> page or the help menu.
		  </p>
			<p>
			  <ul>
			  	<li> <a href="#datasets">Integrated Datasets</a></li>
			    <li> <a href="#3dviewer">The 3D Brain Viewer</a></li>
			    <li> <a href="#querymenu">What can I search for</a></li>
			    <li> <a href="#anatfinder">What information is displayed</a></li>
					<li> <a href="#composite">Overlaying image stacks</a></li>
			    <li> <a href="#querybuilder">Searching for connecting neurons</a></li>
			    <li> <a href="#tech">Technical details</a></li>
					<li> <a href="#browsers">Supported Browsers</a></li>
			  </ul>
			</p>

		  <a name="#datasets"></a>
			<h2>Integrated Datasets</h2>
			<p>These are the current image datasets that are available on the site. We currently only provide adult image data.<br/>
			Any image stack on the site can be displayed in the <a href="../../site/stacks/index.htm">3D Viewer</a>. Any number of images can be displayed at the same time. If an image is available, it will be shown as a thumbnail on the information page for that entity. For all except BrainTrap, the images displayed are registered to the JFRC2 brain template. For more information see <a href="../../site/vfb_site/template_files_downloads.htm">here</a> and <a href="../../site/vfb_site/image_data_downloads.htm">here</a>.
				<ul>
					<li>FlyCircuit neurons <a href="http://dx.doi.org/doi:10.1016/j.cub.2010.11.056" target="_blank">(Chiang et al., 2011, Curr. Biol. 21(1): 1--11)</a></li>
				 	<li>Lineage clone datasets by Tzumin Lee <a href="http://dx.doi.org/doi:10.1016/j.cub.2013.02.057" target="_blank">(Yu et al., 2013, Curr. Biol. 23(8): 633-43)</a> and Kei Ito <a href="http://dx.doi.org/10.1016/j.cub.2013.03.015" target="_blank">(Ito et al., 2013, Curr. Biol. 23(8): 644--655)</a></li>
				 	<li><i>fruitless</i> clone dataset by Cachero and Ostrovsky <a href="http://dx.doi.org/10.1016/j.cub.2010.07.045" target="_blank">(Cachero et al., 2010, Curr. Biol. 20(18): 1589--1601)</a></li>
				 	<li>FlyLight GAL4 lines from Janelia Farm<a href="http://dx.doi.org/10.1016/j.celrep.2012.09.011" target="_blank">(Jenett et al., 2012, Cell Rep. 2(4): 991--1001)</a></li>
				 	<li>BrainTrap protein trap lines <a href="http://dx.doi.org/10.1093/database/baq005" target="_blank">(Knowles-Barley et al., 2010, Database)</a><br/></li>
				</ul>
			</p>

		  <a name="3dviewer"></a>
			<h2>The 3D Brain Viewer</h2>
		  <p>
				Using our <a href="../../site/stacks/index.htm">Viewer</a>, one can explore the anatomy, as well as view image stacks from datasets integrated by VFB. The Viewer is available from the homepage and from the menu 'Stacks'. Under that tab, the templates available on VFB will be shown. Select one template, and click 'Open the Stack Viewer. The full adult brain template corresponds to the Janelia adult brain. A green shortcut button is also available on the header of every page, on the right. The number on the button reflects the number of entities currently displayed in the viewer.
				</p>
				<p>
				The Viewer page is divided into 3 areas: the Stack Viewer and its navigation tools are on left; on the right hand side corresponds to the term info window, where information about a term will be shown and where further queries can be done from. The viewer menu with different tabs and functionalities is shown below the viewer.
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/viewer_intro.png" alt="Main page" style="align:center;padding:5px" width="800">

			<p>
				The template brain (JFRC2) and painted domains stack we currently use are kindly provided by Arnim Jenett of HHMI Janelia Research Campus, and Kei Ito and Kazunori Shinomiya of University of Tokyo.
				The painted domain boundaries comply with the new BrainName's standard nomenclature <a href="http://dx.doi.org/10.1016/j.neuron.2013.12.017" target="_blank">(Ito et al., 2014)</a>. It is available to download from <a href="template_files_downloads.htm">here</a>.
			</p>
			<p>
				Using the Viewer one can:
			</p>
			<ul>
				<li>Explore the image stack by rotating, zooming, or changing the plane of view.
					<img class="img-responsive center-block" src="/images/vfb/project/horizontal.png" alt="Horizontal view" style="align:center;padding:5px" width="400">
	  		</li>

				<li>Clicking on the image will show the name of the neuropil domain in that specific location. The clicked on domain becomes selected and is shown in the Selected tab. 
					To colour highlight a domain, you can either double-click on it, or add it to the viewer by clicking the <a href='#' class='btn btn-xs btn-success' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-paperclip'></span></a> button next to the domain in the Selected tab. The list of displayed entities is shown in the Displayed tab.
				</li>
			  <li> The stack can be centered on any neuropil domain, by clicking the <a href='#' class='btn btn-xs btn-default' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-screenshot'></span></a> button to the left of the domain, in the Displayed tab.</li>

				<li>Search for neuropil domains using the search box in the header or the Anatomy tab. In the first, just type a name or synonym; it allows searching for neuron types, neuron images, lineage clones, etc. In the Anatomy tab, expand the tree using the button at the top and look for the chosen term. Add to the display by clicking the <a href='#' class='btn btn-xs btn-success' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-paperclip'></span></a> button.  
					<img class="img-responsive center-block" src="/images/vfb/project/search.gif" alt="Search box" style="align:center;padding:5px" width="240">
				</li>
				
				<li>All information associated with a term is displayed on the right panel, the term info window. For a selected term, it will show automatically. To see it for a specific displayed entity, click on the name of the domain, or on the <a href='#' class='btn btn-xs btn-default' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-info-sign'></span></a> button next to the name, shown in the various viewer menu tabs. 
					The information includes a definition, synonyms, references, parent classes and ontology relationships. For image stacks, a thumbnail is also shown, if available.
					For example, searching for "protocerebral bridge" would give:
					<img class="img-responsive center-block" src="/images/vfb/project/protocerebral_bridge.png" alt="Simple search for neuropil" style="align:center;padding:5px" width="800">
				</li>
			</ul>

			<p>
				For more details and query examples possible from this page see <a href="#querymenu">What can I search for section</a> below.
		  </p>

	    <a name="querymenu"></a>
			<h2>What can I search for</h2>
			<p>
		  	Searches for anatomical terms can be done from any page, using the search box in the header.
				The query options allow searches for neuron classes, or single neurons by location or connectivity, tracts, lineage, expression of transgenes and genes or phenotypes associated to a neuropil domain or neuron. <br/>
		  	The menu is context dependent, with the query options being different depending if the search starts from a neuron or brain region. In the case of a lineage clone, an additional query is displayed in the neuron menu ('Component neuron').
				Below, on the left, are the query options available for neuropil domains; on the the right, the ones for neurons and lineage clones.
			</p>
			<img class="img-responsive center-block" src="/images/vfb/project/bothmenus.png" alt="Query menus for neuropil domain and neuron" style="align:center;padding:5px" width="600">
			<p>
		  	Once a search for a term has been done, the query menu will appear on the top : look for the 'Query for' menu bar. To see all options available click on the dropdown queries, to the right of 'Query for'.
			<p/>

			<img class="img-responsive center-block" src="/images/vfb/project/protocerebral_bridge_queryfor.png" alt="Query menu in term info window" style="align:center;padding:5px" width="800">

			<p>
				Below are a few examples of possible queries:
			</p>

			<a name="neuronsbylocation"></a>

	    <ul>
	    	<li> <h4>Search for neurons that have synaptic terminals in the "antennal mechanosensory and motor center" (AMMC): </h4></li>


			    <p>
			    	Search for antennal mechanosensory and motor center or one of its synonyms, AMMC. Choose 'Neurons with:' and click on the option 'synaptic terminals here'.
			    </p>
					<img class="img-responsive center-block" src="/images/vfb/project/query1_menu.png" alt="Query menu for neurons by location: AMMC" style="align:center;padding:5px" width="300">

					<p>
						The results window lists all the neurons that innervate the AMMC (default view is 10 items). The name and definition for each neuron type are shown. Clicking on More info will display the full information page, the same as shown in the <a href="../tools/anatomy_finder/index.htm">Anatomy/Neuron Finder</a>. If images of that neuron type are available, they will be shown. Buttons allow display of all images from a neuron type in the Viewer, or listing these in a new page.
				  </p>

					<img class="img-responsive center-block" src="/images/vfb/project/query1.png" alt="Result of query for neurons by location: AMMC" style="align:center;padding:5px" width="800">

					<a name="clusterbylocation"></a>
				<li><h4> Search for individual neurons and neuron images with some part in the antennal lobe:</h4></li>

			    <p>
			    	Search for adult antennal lobe or one of its synonyms, AL. Choose the query: 'Images of neurons with:' and click on the option 'some part here (clustered by shape)'.
			    </p>

					<img class="img-responsive center-block" src="/images/vfb/project/cluster_menu.png" alt="Query menu for single neurons by location: AL" style="align:center;padding:5px" width="300">

			    <p>
						The result window lists groups of morphologically similar neurons or clusters. A thumbnail of the cluster allows a visualisation of the neuron morphology, making it easy to scan the clusters and select the ones of interest. This approach allows not only to find a neuron of interest, but also to quickly find related neurons. Images of the neurons in each cluster are shown on the right. Buttons allow display of all neuron images in a cluster in the Viewer, or listing these in a new page.
			    </p>

			    <img class="img-responsive center-block" src="/images/vfb/project/cluster.png" alt="Result of query for single neurons by location: AL" style="align:center;padding:5px" width="800">

			    <p>
						An interactive 3D representation (WebGL) of each cluster, together with some more cluster information is available by clicking on the cluster thumbnail, or <a href="http://flybrain.mrc-lmb.cam.ac.uk/vfb/fc/clusters/DvGlutMARCM-F003135_seg001/" target="_blank">here</a>.
		  		</p>

		  		<img class="img-responsive center-block" src="/images/vfb/project/cluster_eg.png" alt="3D representation of neuron cluster" style="align:center;padding:5px" width="600">

		  		<p>
						These neuron clusters were obtained using NBLAST, a tool developed by Gregory Jefferis (Division of Neurobiology, MRC Laboratory of Molecular Biology). For more information on how you can use NBLAST see <a href="http://jefferislab.org/si/nblast/">here</a>. This tool was applied to 16129 registered images of single neurons derived from the publicly available FlyCircuit raw image dataset <a href="http://dx.doi.org/doi:10.1016/j.cub.2010.11.056" target="_blank">(Chiang et al., 2011, Curr. Biol. 21(1): 1--11)</a>, resulting in 1052 clusters of similar neurons. We thank the group of A.S. Chiang for taking the lead in making their raw image data available.
			    </p>

		  		<p>
		    		To see all information related to each neuron image, click on 'List individual members'. The results window includes the summary information about each neuron image, including neuron type (if assigned) and driver. To see the full information, click on the neuron name. To display a neuron in the <a href="../../site/stacks/index.htm">Viewer</a>, click on the <a href='#' class='btn btn-xs btn-success' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-paperclip'></span></a> button.
			    </p>

					<img class="img-responsive center-block" src="/images/vfb/project/cluster_showAll.png" alt="All neurons in a cluster with annotations" style="align:center;padding:5px" width="800">

			    <p>
						Matching the neurons in each cluster to previously defined neurons classes is part of our ongoing work.
					</p>

					<a name="expquery"></a>

				<li><h4>Find transgenes expressed in the wedge (also known as IVLP) or in neurons that overlap it </h4></li>

					<p>
			    	Search for 'wedge' or 'IVLP' anc choose the query 'Expression/Phenotypes found here:' and click on the option 'Transgenes expressed here'. The results list will incorporate all the neuron classes known to overlap (partly or completely) that neuropil domain.
			    </p>
					<img class="img-responsive center-block" src="/images/vfb/project/query2_menu.png" alt="Query for transgenes" style="align:center;padding:5px" width="300">
		  </ul>

		  <p>
				Expression and phenotype query results are pulled from <a href="http://www.flybase.org" target="_blank">FlyBase</a >. The results page shows you the driver, where it is expressed, reference and an image of the driver, if available. You can display the image stack on the Viewer by clicking on the green paperclip.
			</p>
			<img class="img-responsive center-block" src="/images/vfb/project/query2.png" alt="Query results for transgenes" style="align:center;padding:5px" width="800">

			<a name="anatfinder"></a>
	    <h2>What information is displayed</h2>
			<p>
				Searches can be done from any page, using the search box in the header of every page. Searches will include all the associated information to a neuron class, neuropil domain, lineage clone or tract. You can also search directly for a neuron image, using for example a FlyCircuit identifier such as Cha-F-50005.
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/searchbox_anatfinder.png" alt="VFB search box" style="align:center;padding:5px" width="300">

		  <p>
		    Searching for a term is made easy by the autocomplete search box which recognises synonyms. Sections displayed for each term include a definition, synonyms, references, parent classes, ontology relationships and thumbnail images, if available.
			</p>

		  <p>
			  Below is an example of a query for "adult antennal lobe projection neuron DA1 lPN" (not all sections are shown):
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/finder_eg.png" alt="Search for neuron" style="align:center;padding:5px" width="800">

			<a name="composite"></a>
			<h2>Overlaying image stacks</h2>
			<p>
				You can overlay any number of images stacks in our <a href="../../site/stacks/index.htm">Viewer</a>. Images or neuropils can be added to the Viewer by clicking the <a href='#' class='btn btn-xs btn-success' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-paperclip'></span></a> button, next to the name of the entity. The list of displayed images is visible on the Displayed tab in the Viewer menu. In this tab, there is also a Clear all button (<a href='#' class="btn btn-xs btn-warning" style="float:left;">Clear all</a>). The number of images in the Viewer is shown in the header of every page, in the green button to the right. Clicking on it will take you to the Viewer.  
				<br/>
				Below, is an example of an overlay of 3 image stacks and 2 neuropils. In green, a single neuron from the FlyCircuit dataset (Cha-F-500059);
				in dark blue the lineage clone LALv1 and in magenta the lineage clone DL1, both from Tzumin Lee's dataset. In addition to the image stacks,
				two neuropils are also selected: noduli (in yellow) and ellipsoid body (in light blue).
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/composite.png" alt="Composite view" width="800" style="align:center;padding:5px" />

			<p>
				To see all the information associated with an image, click on its name and the data will be shown in the term info window below the Viewer.
			</p>

			<a name="querybuilder"></a>
			<h2>Searching for connecting neurons</h2>
			<p>
				The query menu described above, associated with terms in the anatomy tree or in the <a href="../tools/anatomy_finder/index.htm">Anatomy/Neuron Finder</a>
				provides a quick and convenient way to run most common queries on single anatomy terms.
				The Query tab on the <a href="../../site/stacks/index.htm">Viewer</a> page allows the building and execution of more complex queries. For example, to find neurons that innervate two different anatomical regions specifying the directionality of these connections. 				
			</p>

		  <img class="img-responsive center-block" src="/images/vfb/project/queryBuilder.png" alt="Query Builder" style="align:center;padding:5px" width="800">

			<p>
				Neuropil domains can be selected using any of the methods above.
				 To add a term, click on the <a href='#' class='btn btn-xs btn-info' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-tasks'></span></a> button next to a term's name, to the right of the <a href='#' class='btn btn-xs btn-success' ><span style='border:none;padding-left:0px;padding-right:0px;' class='glyphicon glyphicon-paperclip'></span></a> button.
				 </p>
				 <p>
				Once a term has been added, it will be shown in the 'Query' tab. You can specify the directionality of the innervation by choosing the type of terminals: pre-, postsynaptic or any (synaptic) using the drop-down menu underneath the chosen term. Add another term in the same way. Queries can have multiple legs.
				</p>
				
			<p>
				In order to prevent executing empty queries, a running count of results is displayed whilst you compose your query ('Records found'). Click the Show Results' button to browse the results.
				</p>
				<p>
				Below are the results from the query "Find all neurons that have postsynaptic terminals in medulla and have presynaptic terminals in lobula":
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/queryBuilder1.png" alt="Query result" style="align:center;padding:5px" width="800">

			<a name="tech"></a>
			<h2>Technical details</h2>
			<p>
				The Virtual Fly Brain (VFB) browser application consists of the Image Server and a lightweight client.
				The Image Server uses the <a href="http://iipimage.sourceforge.net/" target="_blank">Internet Imaging Protocol</a> that streams image tiles that are
				specified by a client's request. This tile-based approach for viewing large, high-resolution images is widely used by popular
				providers such as <a href="http://google.com" target="_blank">Google</a> or
				<a href="http://www.zoomify.com/" target="_blank">Zoomify</a>, as well as by research projects
				such as <a href="http://www.eurexpress.org/ee/" target="_blank">Eurexpress</a>. <br/>
				The key advantage of such an approach is that the client only downloads
				the portion of the whole image that is visible, rather than the entire image. This efficiently uses bandwidth and memory, allowing it to
				be usable even over slow internet connections. An extension of the IIP protocol that we use allows to serve arbitrary sections of a 3D
				object in <i>Woolz</i> format. Please see the overall architecture of the VFB application below:
			</p>

			<img class="img-responsive center-block" src= "/images/vfb/project/architecture.png" alt="Overall architecture" width="580" style="padding:5px"/>

			<p>
				Please feel free to download a <a href="/public_resources/NeuroFly2010.ppt">poster</a> for more details on the application
				or refer to the <a href="http://www.emouseatlas.org/emap/analysis_tools_resources/software/woolz.html" target="_blank">Woolz page</a>
				for details on Woolz software and IIP3D protocol.
			</p>

			<p>
		    The images served by this protocol and displayed on VFB are annotated using an ontology of the Drosophila brain anatomy developed
				by VFB in co-ordination with <a href="http://www.flybase.org" target="_blank">FlyBase</a>.  This ontology contains referenced,
				textual descriptions of painted domains (brain regions) and relates these domains to each other,
				to unpainted subdomains, and to neurons. The ontology follows the W3C standard,
				<a href="http://www.w3.org/TR/owl2-primer/" target="_blank">OWL2</a>. This allows us to use standard
				<a href="http://owlapi.sourceforge.net/reasoners.html" target="_blank">OWL reasoning software</a>
				to drive queries on the site for neurons by their location and innervation patterns.
		  </p>
		  <p>
		  	This ontology is used extensively to record gene/transgene expression and phenotypes in FlyBase.
				By combining reasoner driven queries of the ontology with queries of FlyBase,
				VFB allows simple point-and-click queries for neuroanatomy, expression and phenotypes.
		  </p>

		</div> <!-- well -->
	</div> <!-- center_wide -->

</div> <!-- row -->


<jsp:include page="/jsp/includes/homeFoot.jsp" />
