<jsp:include page="/jsp/includes/homeHead.jsp" >
	<jsp:param name="navpath" value="The VFB Site@/site/vfb_site/home.htm|Features@ " />
	<jsp:param name="title" value="Features" />
</jsp:include>



<div class="row row-centered">

	<div class="col-md-9 col-centered">
		<div class="jumbotron" align="center">
			<jsp:include page="/site/vfb_site/whats_new.htm" />
		</div>

		<div class="center-wide">



			<p>
				Welcome to <b>Virtual Fly Brain (VFB)</b> - an interactive tool for neurobiologists to explore the detailed neuroanatomy, neuron connectivity and gene expression of the adult <i>Drosophila melanogaster</i> brain.
				Our goal is to make it easier for researchers to find relevant anatomical information and reagents.
				We integrate the neuroanatomical and expression data from the published literature, as well as image datasets onto the same brain template, making it possible to run cross searches, find similar neurons and compare image data on our <a href="../../site/stacks/index.htm">Viewer</a>.
			</p>

			<p>
				Our site provides several anatomy browsing, image display and querying tools.
			</p>
			<p>
				Below is a short description of the datasets and tools available and what they will allow you to do.
				For more detailed information on each tool please check our <a href="tutorial.htm">Tutorial videos</a> page or the help menu.
		  </p>
			<p>
			  <ul>
			  	<li> <a href="#datasets">Integrated Datasets</a></li>
			    <li> <a href="#3dviewer">The 3D Brain Viewer</a></li>
			    <li> <a href="#querymenu">What can I search for</a></li>
			    <li> <a href="#anatfinder">The Anatomy/Neuron Finder</a></li>
					<li> <a href="#composite">Overlaying image stacks</a></li>
			    <li> <a href="#querybuilder">Searching for connecting neurons</a></li>
			    <li> <a href="#tech">Technical details</a></li>
					<li> <a href="#browsers">Supported Browsers</a></li>
			  </ul>
			</p>

		  <a name="#datasets"></a>
			<h2>Integrated Datasets</h2>
			<p>
				<ul>
					<li>FlyCircuit neurons <a href="http://dx.doi.org/doi:10.1016/j.cub.2010.11.056" target="_new">(Chiang et al., 2011, Curr. Biol. 21(1): 1--11)</a></li>
				 	<li>Lineage clone datasets by Tzumin Lee <a href="http://dx.doi.org/doi:10.1016/j.cub.2013.02.057" target="_new">(Yu et al., 2013, Curr. Biol. 23(8): 633-43)</a> and Kei Ito <a href="http://dx.doi.org/10.1016/j.cub.2013.03.015" target="_new">(Ito et al., 2013, Curr. Biol. 23(8): 644--655)</a></li>
				 	<li><i>fruitless</i> clone dataset by Cachero and Ostrovsky <a href="http://dx.doi.org/10.1016/j.cub.2010.07.045" target="_new">(Cachero et al., 2010, Curr. Biol. 20(18): 1589--1601)</a></li>
				 	<li>FlyLight GAL4 lines from Janelia Farm<a href="http://dx.doi.org/10.1016/j.celrep.2012.09.011" target="_new">(Jenett et al., 2012, Cell Rep. 2(4): 991--1001)</a></li>
				 	<li>BrainTrap protein trap lines <a href="http://dx.doi.org/10.1093/database/baq005" target="_new">(Knowles-Barley et al., 2010, Database)</a><br/></li>
				</ul>
			</p>

		  <a name="3dviewer"></a>
			<h2>The 3D Brain Viewer</h2>
		  <p>
				Using our <a href="../../site/stacks/index.htm">Viewer</a>, one can explore the anatomy of the adult brain, as well as view image stacks from datasets integrated by VFB. The Viewer is available from the homepage, from the menu 'Stacks> Adult Brain-Janelia' or click <a href="../../site/stacks/index.htm">here</a>.
				This page is divided into 3 areas: the Stack Viewer and its navigation tools are on the upper left and central panels; on the right hand side is an interactive anatomy tree; the lower panel corresponds to the term info window.
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/vfb1.png" alt="Main page" width="650">

			<p>
				The template brain (JFRC2) and painted domains stack we currently use are kindly provided by Arnim Jenett of HHMI Janelia Farm research campus, and Kei Ito and Kazunori Shinomiya of University of Tokyo.
				The painted domain boundaries comply with the new BrainName's standard nomenclature <a href="http://dx.doi.org/10.1016/j.neuron.2013.12.017" target="_new">(Ito et al., 2014)</a>. It is available to download from <a href="template_files_downloads.htm">here</a>.
			</p>
			<p>
				Using the Viewer one can:
			</p>
			<ul>
				<li>Explore the image stack by rotating, zooming, or changing the plane of view.
					<img class="img-responsive center-block" src="/images/vfb/project/horizontal.png" alt="Horizontal view" style="align: center;" width="400">
	  		</li>

				<li>Hovering over the image will show the names of the neuropil domains.
					Domains can be selected (colour highlighted) by double-clicking on the stack or by clicking on the term in the anatomy tree.
					Selected domains will be highlighted in both the stack and the tree.
				</li>
			  <li> The stack can be centered on any neuropil domain, by clicking the red 'centre' button on the tree.</li>

				<li>Search for neuropil domains using the autocomplete search box (below) on top of the anatomy tree,
					which recognises synonyms, or by simply browsing the tree.
					<img class="img-responsive center-block" src="/images/vfb/project/search.gif" alt="Search box" style="align:center;" width="240">
				</li>
				<li>Once you have found and selected your term, all information associated with it is displayed in the lower panel, the term info window.
					This includes a definition, synonyms, references, parent classes and ontology relationships.
					For example, searching for "protocerebral bridge" would give:
					<img class="img-responsive center-block" src="/images/vfb/project/annotation.png" alt="Simple search for neuropil" style="align:center;" width="650">
				</li>
				<li> If multiple terms are selected, only the last selected term will be shown on the term info window.
					The information displayed is the same as the one in the <a href="../tools/anatomy_finder/index.htm">Anatomy/Neuron Finder</a> page for that term.</li>
			</ul>

			<p>
				For more details and query examples possible from this page see <a href="#querymenu">What can I search for section</a> below.
		  </p>

	    <a name="querymenu"></a>
			<h2>What can I search for</h2>
			<p>
		  	Searches for anatomical terms can be done from the homepage, from the <a href="../tools/anatomy_finder/index.htm">Anatomy/Neuron Finder</a> or <a href="../../site/stacks/index.htm">Viewer</a> (for neuropils only).
				The query options allow searches for neuron classes, or single neurons by location or connectivity, tracts, lineage, expression of transgenes and genes or phenotypes associated to a neuropil domain or neuron. <br/>
		  	The menu is context dependent, with the query options being different depending if the search starts from a neuron or brain region. In the case of a lineage clone, an additional query is displayed in the neuron menu ('Component neuron').
				Below, on the left, is the query options available for neuropil domains; on the the right, the one for neurons and lineage clones.
			</p>
			<img class="img-responsive center-block" src="/images/vfb/project/bothmenus.png" alt="Query menus for neuropil domain and neuron" style="align:center;" width="600">
			<p>
		  	Once a search has been done, the query menus wil appear on the top left: look for the 'Query for' menu bar. To see the options available for each of the query menus to the right of 'Query for', hover the mouse over each one.
			<p/>

			<img class="img-responsive center-block" src="/images/vfb/project/annotation_querymenu.png" alt="Query menu in term info window" style="border: 1px solid gray;" width="650">

			<p>
				Below are a few examples of possible queries:
			</p>

			<a name="neuronsbylocation"></a>

	    <ul>
	    	<li> <h4>Search for neurons that have synaptic terminals in the "antennal mechanosensory and motor center" (AMMC): </h4></li>


			    <p>
			    	Search for antennal mechanosensory and motor center or one of its synonyms, AMMC. Hover on 'Neuron classes with:' and click on the option 'synaptic terminals here'.
			    </p>
					<img class="img-responsive center-block" src="/images/vfb/project/query1_menu.png" alt="Query menu for neurons by location: AMMC" style="border: 1px solid gray;" width="200">

					<p>
						The results window lists all the neurons that innervate the AMMC. Clicking on 'More info' will display an information window for that term, displaying the same information as in the term info window or in the <a href="../tools/anatomy_finder/index.htm">Anatomy/Neuron Finder</a> for that term.
				  </p>

					<img class="img-responsive center-block" src="/images/vfb/project/query1.png" alt="Result of query for neurons by location: AMMC" style="border: 1px solid gray;" width="600">

					<a name="clusterbylocation"></a>
				<li><h4> Search for individual neurons and neuron images with some part in the antennal lobe:</h4></li>

			    <p>
			    	Search for antennal lobe or one of its synonyms, AL. Choose the query: 'Individual neurons with:' and click on the option 'some part here'.
			    </p>

					<img class="img-responsive center-block" src="/images/vfb/project/cluster_menu.png" alt="Query menu for single neurons by location: AL" style="border: 1px solid gray;" width="200">

			    <p>
						The results window lists groups of morphologically similar neurons or clusters. A thumbnail of the cluster allows a visualisation of the neuron morphology, making it easy to scan the clusters and select the ones of interest. This approach allows not only to find a neuron of interest, but also to quickly find related neurons.
			    </p>

			    <img class="img-responsive center-block" src="/images/vfb/project/cluster.png" alt="Result of query for single neurons by location: AL" style="border: 1px solid gray;" width="600">

			    <p>
						An interactive 3D representation (WebGL) of each cluster, together with some more cluster information is available by clicking on the cluster thumbnail, or <a href="http://flybrain.mrc-lmb.cam.ac.uk/vfb/fc/clusters/DvGlutMARCM-F003135_seg001/" target="_new">here</a>.
		  		</p>

		  		<img class="img-responsive center-block" src="/images/vfb/project/cluster_eg.png" alt="3D representation of neuron cluster" style="border: 1px solid gray;" width="600">

		  		<p>
						These neuron clusters were obtained using NBLAST, a tool developed by Gregory Jefferis (Division of Neurobiology, MRC Laboratory of Molecular Biology). For more information on how you can use NBLAST see <a href="http://jefferislab.org/si/nblast/">here</a>. This tool was applied to 16129 registered images of single neurons derived from the publicly available FlyCircuit raw image dataset <a href="http://dx.doi.org/doi:10.1016/j.cub.2010.11.056" target="_new">(Chiang et al., 2011, Curr. Biol. 21(1): 1--11)</a>, resulting in 1052 clusters of similar neurons. We thank the group of A.S. Chiang for taking the lead in making their raw image data available.
			    </p>

		  		<p>
		    		To show all neurons in a cluster, click on 'Show individual members'. The results window provides links to the original data, and displays the annotation and driver for each neuron.<br />
						To look at the image stack for a neuron in the <a href="../../site/stacks/index.htm">Viewer</a>, click on the link "See in Viewer". For help on how to overlay images see <a href=#composite>here</a>.
			    </p>

					<img class="img-responsive center-block" src="/images/vfb/project/cluster_showAll.png" alt="All neurons in a cluster with annotations" style="border: 1px solid gray;" width="600">

			    <p>
						Matching the neuron clusters to previously defined neurons classes is part of our ongoing work.
					</p>

					<a name="expquery"></a>

				<li><h4>Find transgenes expressed in the wedge (also known as IVLP) or in neurons that overlap it </h4></li>

					<p>
			    	Search for 'wedge' or 'IVLP' anc choose the query 'Expression/Phenotypes found here:' and click on the option 'Transgenes expressed here'. The results list will incorporate all the neuron classes known to overlap (partly or completely) that neuropil domain.
			    </p>
					<img class="img-responsive center-block" src="/images/vfb/project/query2_menu.png" alt="Query for transgenes" style="border: 1px solid gray;" width="200">
		  </ul>

		  <p>
				Expression and phenotype query results are pulled from <a href="http://www.flybase.org" target="_new">FlyBase</a >. The results page shows you the driver, where it is expressed, reference and an image of the driver, if available.
			</p>
			<img class="img-responsive center-block" src="/images/vfb/project/query2.png" alt="Query results for transgenes" style="border: 1px solid gray;" width="600">

			<a name="anatfinder"></a>
	    <h2>The Anatomy/Neuron Finder</h2>
			<p>
				This search tool, available on the homepage, or in <a href="../tools/anatomy_finder/index.htm">Tools</a>,
				displays all the associated information to a neuron class, neuropil domain, lineage clone or tract,
				similar to the term info window in the <a href="../../site/stacks/index.htm">Viewer</a> page.
				Links to the Brain Viewer page ('See in Viewer') from neuropil domains allow easy visualisation of the brain anatomy.
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/searchbox_anatfinder.png" alt="Neuron or neuropil search box" style="border: 1px solid gray;" width="300">

		  <p>
		    Searching for a term is made easy by the autocomplete search box which recognises synonyms.
				Sections displayed for each term include a definition, synonyms, references, parent classes,
				ontology relationships and example neuron or lineage clone images.
			</p>

		  <p>
		    Direct queries on neuron classes are only possible on this page, not on the interactive anatomy tree in the
				<a href="../../site/stacks/index.htm">Viewer</a> page.
			</p>
		  <p>
			  Below is an example of a query for "adult antennal lobe projection neuron DA1 lPN" (not all sections are shown):
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/finder_eg.png" alt="Search for neuron" style="border: 1px solid gray;" width="600">

			<a name="composite"></a>
			<h2>Overlaying image stacks</h2>
			<p>
				This functionality allows you to compare registered images in our <a href="../../site/stacks/index.htm">Viewer</a>.
				Whenever available, thumbnails of images of single neurons, lineage clones or expression patterns will be displayed on the results list or on the term info panel,
				and any of these images can be selected to be displayed in the Viewer. Up to three different image stacks can be overlayed at the same time, together with any neuropil domains that are selected.
				<br/>
				Below, is an example of a composite view. In red, a single neuron from the FlyCircuit dataset (Cha-F-500059);
				in blue the lineage clone LALv1 and in green the lineage clone DL1, both from Tzumin Lee's dataset. In addition to the image stacks,
				two neuropils are also selected: noduli (in violet) and ellipsoid body (in yellow).
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/composite.png" alt="Composite view" width="650" style="border: 1px solid gray" />

			<p>
				To create a composite view, you first need to select the image stacks.
				From any thumbnail image, click 'See in Viewer'. From the <a href="../../site/stacks/index.htm">Viewer</a> page,
				you can add the stack to the composite view by clicking 'Add to composite view' on the left hand side,
				under 'Stack actions'. This will take you to the Composite view page,
				where you can see what stacks are currently selected. To add more stacks,
				just click on the back button of your browser to return to your query results, or to run a new search.
				At any time, you can click on 'Edit current composite view' on the upper right to check what stacks you have already added.
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/composite_labels.png" alt="Composite view" width="650" style="border: 1px solid gray" />

			<p>
				Once you have added the stacks you want to overlay, from the Composite page, click on 'View composite'.
				Each composite view has a unique link (permalink), which allows you to share it with others (non-editable).
				To obtain this link click on 'Get permalink and start new composite'.
			</p>
			<img class="img-responsive center-block" src="/images/vfb/project/composite_view.png" alt="Composite view" width="650" style="border: 1px solid gray" />

			<a name="querybuilder"></a>
			<h2>Searching for connecting neurons</h2>
			<p>
				The query menu described above, associated with terms in the anatomy tree or in the <a href="../tools/anatomy_finder/index.htm">Anatomy/Neuron Finder</a>
				provides a quick and convenient way to run most common queries on single anatomy terms.
				However, the <a href="../tools/query_builder/index.htm">Query Builder</a> allows the building and execution of more complex queries,
				for example, to find neurons that innervate two different anatomical regions specifying the directionality of these connections. <br/>
				This search tool is available on the homepage, or <a href="../tools/query_builder/index.htm">here</a>.
			</p>

		  <img class="img-responsive center-block" src="/images/vfb/project/queryBuilder.png" alt="Query Builder" style="border: 1px solid gray;" width="600">

			<p>
				Neuropil domains can be selected from the interactive anatomy tree and easily added to the query clicking 'Add to the query' at the top of the term info window. <br/>
				Once a term has been added, you can specify the directionality of the innervation by choosing the type of terminals: pre-, postsynaptic or any (synaptic) using the drop-down menu to the right of your chosen term.
				Queries can have multiple query legs.
			</p>
			<p>
				In order to prevent executing empty queries, a running count of results is displayed whilst you compose your query ('Records found'). Click the "Execute" button to browse the results.
				<br/>
				Below is the results from the query "Find all neurons that have postsynaptic terminals in medulla and have presynaptic terminals in lobula":
			</p>

			<img class="img-responsive center-block" src="/images/vfb/project/queryBuilder1.png" alt="Query result" style="border: 1px solid gray;" width="600">

			<a name="tech"></a>
			<h2>Technical details</h2>
			<p>
				The Virtual Fly Brain (VFB) browser application consists of the Image Server and a lightweight client.
				The Image Server uses the <a href="http://iipimage.sourceforge.net/" target="_new">Internet Imaging Protocol</a> that streams image tiles that are
				specified by a client's request. This tile-based approach for viewing large, high-resolution images is widely used by popular
				providers such as <a href="http://google.com" target="_new">Google</a> or
				<a href="http://www.zoomify.com/" target="_new">Zoomify</a>, as well as by research projects
				such as <a href="http://www.eurexpress.org/ee/" target="_new">Eurexpress</a>. <br/>
				The key advantage of such an approach is that the client only downloads
				the portion of the whole image that is visible, rather than the entire image. This efficiently uses bandwidth and memory, allowing it to
				be usable even over slow internet connections. An extension of the IIP protocol that we use allows to serve arbitrary sections of a 3D
				object in <i>Woolz</i> format. Please see the overall architecture of the VFB application below:
			</p>

			<img class="img-responsive center-block" src= "/images/vfb/project/architecture.png" alt="Overall architecture" width="580" style="padding:5px"/>

			<p>
				Please feel free to download a <a href="/public_resources/NeuroFly2010.ppt">poster</a> for more details on the application
				or refer to the <a href="http://www.emouseatlas.org/emap/analysis_tools_resources/software/woolz.html" target="_new">Woolz page</a>
				for details on Woolz software and IIP3D protocol.
			</p>

			<p>
		    The images served by this protocol and displayed on VFB are annotated using an ontology of the Drosophila brain anatomy developed
				by VFB in co-ordination with <a href="http://www.flybase.org" target="_new">FlyBase</a>.  This ontology contains referenced,
				textual descriptions of painted domains (brain regions) and relates these domains to each other,
				to unpainted subdomains, and to neurons. The ontology follows the W3C standard,
				<a href="http://www.w3.org/TR/owl2-primer/" target="_new">OWL2</a>. This allows us to use standard
				<a href="http://owlapi.sourceforge.net/reasoners.html" target="_new">OWL reasoning software</a>
				to drive queries on the site for neurons by their location and innervation patterns.
		  </p>
		  <p>
		  	This ontology is used extensively to record gene/transgene expression and phenotypes in FlyBase.
				By combining reasoner driven queries of the ontology with queries of FlyBase,
				VFB allows simple point-and-click queries for neuroanatomy, expression and phenotypes.
		  </p>

		</div> <!-- well -->
	</div> <!-- center_wide -->

	<!--<div class="col-md-3">
		<jsp:include page="/jsp/includes/bits/homeRight.jsp" />
	</div>-->
</div> <!-- row -->


<jsp:include page="/jsp/includes/homeFoot.jsp" />
